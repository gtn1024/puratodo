# PuraToDo Development Progress

## Project Overview
A modern todo application built with Next.js 16+, Supabase, and Tailwind CSS.
Supports groups, lists, and infinitely nested tasks.

## Tech Stack
- Frontend: Next.js 16+ (App Router) + TypeScript + Tailwind CSS v4 + shadcn/ui
- Backend: Supabase (PostgreSQL + Auth + Realtime + RLS)
- Testing: Playwright MCP (E2E)

## Data Model

```
users (Supabase Auth)
    └── groups (1:N)
            └── lists (1:N)
                    └── tasks (1:N, self-referencing for subtasks)
```

All tables include user_id for RLS policies and query optimization.

---

### 2026-02-16

#### 完成
- Feature #18: List UI - 显示列表
  - 创建 src/actions/lists.ts server action（getLists, createList, updateList, deleteList, reorderLists, moveListToGroup）
  - 创建 src/components/dashboard/list-panel.tsx 列表面板组件
  - 更新 Sidebar 组件支持分组选择（selectedGroupId, onGroupSelect）
  - 重构 Dashboard 页面，分离 DashboardContent 客户端组件
  - 列表显示名称和 emoji 图标
  - 修复分组切换后列表不更新的问题（改进点击事件处理）
- Feature #19: List Create - 创建列表
  - 已在 ListPanel 中实现创建对话框
  - 支持名称和 12 种 emoji 图标选择
  - 测试通过
- Feature #17.5: Sidebar Tree - 侧边栏树形结构
  - 重构 Sidebar 组件支持在分组下方显示子列表
  - 添加展开/收起功能（ChevronRight/ChevronDown 图标）
  - 显示列表数量徽章
  - 点击列表更新主区域标题
  - 点击分组菜单可添加列表
  - 测试通过
- Feature #20: List Edit - 编辑列表
  - 编辑对话框已存在于 ListPanel
  - 支持修改名称和图标
  - 测试通过
- Feature #21: List Delete - 删除列表
  - 删除确认对话框已存在于 ListPanel
  - 显示删除警告（会删除关联任务）
  - 测试通过
- Feature #22: List Sort - 拖拽排序列表
  - 使用 @dnd-kit 在 ListPanel 中添加拖拽排序功能
  - 创建 SortableListItem 组件处理单个可排序列表项
  - 添加 GripVertical 拖拽手柄，hover 时显示
  - 使用 reorderLists server action 批量更新 sort_order
  - 测试通过：拖拽排序后刷新页面顺序持久化
- Feature #23: List Move - 移动列表到其他分组
  - 在 ListPanel 中添加移动对话框
  - 显示可选的目标分组列表（排除当前分组）
  - 使用 moveListToGroup server action 更新 group_id
  - 添加 FolderInput 图标到 Move 菜单项
  - 测试通过：列表成功移动到其他分组并持久化
- 侧边栏列表拖拽排序
  - 添加 SortableSidebarListItem 组件
  - 在每个分组内添加独立的 DndContext 处理列表排序
  - 侧边栏和主面板列表排序同步更新
  - 测试通过
- Feature #24: Task UI - 显示任务
  - 创建 src/actions/tasks.ts server action（getTasks, createTask, updateTask, deleteTask, reorderTasks）
  - 创建 src/components/dashboard/task-panel.tsx 任务面板组件
  - 安装 shadcn/ui Checkbox 组件
  - 更新 dashboard-content.tsx 根据 selectedListId 显示任务面板
  - 测试通过
- Feature #25: Task Create - 创建任务
  - TaskPanel 中添加内联输入创建任务
  - 支持 Enter 快捷键提交
  - 测试通过
- Feature #26: Task Complete - 标记完成
  - 使用 Checkbox 组件切换完成状态
  - 完成任务显示删除线样式
  - 测试通过
- Feature #30: Task Star - 星标任务
  - 点击星标图标切换 starred 状态
  - 测试通过

#### 下一步
- 实现 Feature #27: Task Edit - 编辑任务名称
- 实现 Feature #28: Task Delete - 删除任务
- 实现 Feature #29: Task Sort - 拖拽排序任务

---

### 2026-02-15

#### 完成
- 重构 feature_list.json：从 phase 嵌套结构改为扁平数字编号 (1-52)
- 为每个 feature 添加 steps 字段，指导 Playwright 测试步骤
- 更新 claude-progress.txt 适配新格式
- Feature #16: Group Sort - 拖拽排序分组
  - 安装 @dnd-kit/core, @dnd-kit/sortable, @dnd-kit/utilities
  - 添加 reorderGroups server action 批量更新 sort_order
  - 更新 Sidebar 组件支持拖拽排序（SortableGroupItem 组件）
  - 添加 GripVertical 拖拽手柄，hover 时显示
- Feature #18: List UI - 显示列表
  - 创建 src/actions/lists.ts server action（getLists, createList, updateList, deleteList, reorderLists, moveListToGroup）
  - 创建 src/components/dashboard/list-panel.tsx 列表面板组件
  - 更新 Sidebar 组件支持分组选择（selectedGroupId, onGroupSelect）
  - 重构 Dashboard 页面，分离 DashboardContent 客户端组件
  - 列表显示名称和 emoji 图标

#### 下一步
- **Feature #17.5: Sidebar Tree - 侧边栏树形结构显示列表（新增）**
- 实现 Feature #19: List Create - 创建列表（已在测试中实现）
- 实现 Feature #20: List Edit - 编辑列表（已在测试中实现）
- 实现 Feature #21: List Delete - 删除列表（已在测试中实现）
- 继续实现 Feature #22-23: List Sort/Move

---

### 2026-02-14

#### 完成
- Feature #12: Group List UI - 侧边栏显示分组列表
- Feature #13: Group Create - 创建分组（名称+颜色选择器）
- Feature #14: Group Edit - 编辑分组名称和颜色
- Feature #15: Group Delete - 删除分组（带确认对话框）
- Feature #17: Group Sidebar - 左侧固定侧边栏布局

#### 下一步
- 实现 Feature #16: Group Sort 或继续 List Module

---

### 2026-02-13

#### 完成
- Feature #6-11: 完整认证系统
  - #6: 登录页面 UI
  - #7: 用户注册
  - #8: 用户登录
  - #9: 用户登出
  - #10: Session 持久化
  - #11: 路由保护

#### 下一步
- Group Module 功能实现

---

### 2026-02-12

#### 完成
- Feature #1-5: 项目初始化
  - #1: Next.js 项目脚手架
  - #2: shadcn/ui 安装配置
  - #3: Supabase 项目创建
  - #4: 数据库 Schema
  - #5: Supabase Client 配置

#### 下一步
- 认证系统实现

---

## Notes
- Using Tailwind CSS v4 (latest)
- Next.js 16.1.6 with App Router
- shadcn/ui with new-york style, neutral color scheme
- All features tested with Playwright MCP
